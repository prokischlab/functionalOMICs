<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Dmitrii Smirnov" />

<meta name="date" content="2021-07-05" />

<title>OddsPath for mono-allelic expression</title>

<script src="libR/header-attrs-2.8/header-attrs.js"></script>
<script src="libR/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libR/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="libR/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="libR/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="libR/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="libR/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="libR/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="libR/tocify-1.9.1/jquery.tocify.js"></script>
<script src="libR/navigation-1.1/tabsets.js"></script>
<script src="libR/navigation-1.1/codefolding.js"></script>
<script src="libR/navigation-1.1/sourceembed.js"></script>
<link href="libR/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="libR/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="lib/add_content_table.css" type="text/css" />
<link rel="stylesheet" href="lib/leo_style.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>



<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">OddsPath for mono-allelic expression</h1>
<h4 class="author">Dmitrii Smirnov</h4>
<h4 class="date">2021-07-05</h4>

</div>


<pre class="r"><code>source(snakemake@input$config)
# source(&#39;src/config.R&#39;)


vto &lt;- fread(&#39;data/MAE_P_B_variants.csv&#39;)

#table(vto[, .(var_type, Pathogenicity)])
#table(vto[Pathogenicity == &quot;Pathogenic&quot;, .(var_type, MAE_cause)])


#uniqueN(vto$RNA_ID) #114
#uniqueN(vto[Pathogenicity == &quot;Pathogenic&quot;]$RNA_ID) #42

#uniqueN(vto$geneID) #140
#uniqueN(vto[Pathogenicity == &quot;Pathogenic&quot;]$geneID) # 37
#nrow(vto[Pathogenicity == &quot;Pathogenic&quot;]) #74


mae_colors &lt;- c(  &quot;Benign&quot; = &quot;gray80&quot;,
                  &quot;Pathogenic&quot; = &quot;#C27BA0&quot;,
                  &quot;Overrepresented&quot;= &quot;#80CEE1&quot;,
                  &quot;Underrepresented&quot; = &quot;#CAE7C1&quot;,
                  &quot;No rare variant&quot;= &quot;gray80&quot;)

vto[ , Pathogenicity2 := Pathogenicity]
vto[Pathogenicity == &quot;Pathogenic&quot; &amp; MAE_cause == &quot;F&quot; , Pathogenicity2 := &quot;Overrepresented&quot;] # blue
vto[Pathogenicity == &quot;Pathogenic&quot; &amp; MAE_cause == &quot;T&quot; , Pathogenicity2 := &quot;Underrepresented&quot;] # green </code></pre>
<p>1</p>
<pre class="r"><code>Fig5 &lt;- ggplot(vto, aes(var_type, alt_freq) )+
  geom_quasirandom(data= vto[Pathogenicity == &quot;Benign&quot; ],aes(var_type, alt_freq, fill = Pathogenicity2, shape = genotype, size = Significance), color = &quot;grey20&quot;)+
  geom_quasirandom(data= vto[Pathogenicity == &quot;Pathogenic&quot; ],aes(var_type, alt_freq, fill = Pathogenicity2, shape = genotype, size = Significance), color = &quot;grey20&quot;)+
  scale_shape_manual(values = gene_shapes, guide = guide_legend(override.aes = list(fill = &quot;black&quot;, size = 3, order = 1)) ) +
  scale_fill_manual(values = mae_colors, guide = guide_legend(override.aes = list(shape = 23, size = 3, order = 2))) +
  scale_size_manual(values = gene_size) +
  xlab(&quot;&quot;) + 
  ylab(&quot;Alternative allele ratio&quot;) +
  labs(fill = &quot;Pathogenicity&quot;, 
       size = &quot;Significance&quot;,
       shape = &quot;Genotype&quot;)+  
  geom_hline(yintercept = 0.5)+
  geom_hline(yintercept = 0.2, linetype = &quot;dashed&quot;)+
  geom_hline(yintercept = 0.8, linetype = &quot;dashed&quot;)+
  theme_classic()+
  theme(axis.title.y= element_text( size=12,  face=&quot;bold&quot;),
        axis.title.x= element_text( size=12,  face=&quot;bold&quot;),
        axis.text.x = element_text(face=&quot;bold&quot;,  size=12),
        axis.text.y= element_text(face=&quot;bold&quot;,  size=12))</code></pre>
<pre class="r"><code>Fig5</code></pre>
<p><img src="Scripts_RNA_seq_MAE_files/figure-html/unnamed-chunk-3-1.png" width="960" /></p>
<pre class="r"><code>###########################################################################
##### P-value
##################################################

#### P-value iteration
#thresholds &lt;- seq(0, 0.05, 0.001)

thresholds &lt;- c(0.0001,0.0005, 0.001, 0.005, 0.01, 0.05)
t_iter &lt;- data.frame()
for (t in thresholds){
  ### All
  P1 &lt;- nrow(vto[Pathogenicity == &quot;Pathogenic&quot; ]) / nrow(vto)
  P2 &lt;- nrow(vto[Pathogenicity == &quot;Pathogenic&quot; &amp;  MAE_PVALUE &lt; t]) / 
    (nrow(vto[ MAE_PVALUE &lt; t]) +1 )
  
  df &lt;- data.frame(&quot;Type&quot; = &quot;P-value&quot;,
                   &quot;Variant_type&quot; = &quot;All&quot;,
                   &quot;Threshold&quot; = t,
                   &quot;OddsPath&quot; = (P2 * (1 - P1) ) / ((1 - P2) * P1 ) )
  
  t_iter &lt;- rbind(t_iter, df)
  
  ### PTV
  P1 &lt;- nrow(vto[Pathogenicity == &quot;Pathogenic&quot; ]) / nrow(vto)
  P2 &lt;- nrow(vto[Pathogenicity == &quot;Pathogenic&quot; &amp;  var_type == &quot;PTV&quot; &amp;  MAE_PVALUE &lt; t]) / 
    (nrow(vto[var_type == &quot;PTV&quot; &amp; MAE_PVALUE &lt; t]) +1 )
  
  df &lt;- data.frame(&quot;Type&quot; = &quot;P-value&quot;,
                   &quot;Variant_type&quot; = &quot;PTV&quot;,
                   &quot;Threshold&quot; = t,
                   &quot;OddsPath&quot; = (P2 * (1 - P1) ) / ((1 - P2) * P1 ) )
  
  t_iter &lt;- rbind(t_iter, df)
  
  ### Coding
  P1 &lt;- nrow(vto[Pathogenicity == &quot;Pathogenic&quot; ]) / nrow(vto)
  P2 &lt;- nrow(vto[Pathogenicity == &quot;Pathogenic&quot; &amp;  var_type == &quot;Coding&quot; &amp; MAE_PVALUE &lt; t]) / 
    (nrow(vto[var_type == &quot;Coding&quot; &amp; MAE_PVALUE &lt; t]) +1 )
  
  df &lt;- data.frame(&quot;Type&quot; = &quot;P-value&quot;,
                   &quot;Variant_type&quot; = &quot;Coding&quot;,
                   &quot;Threshold&quot; = t,
                   &quot;OddsPath&quot; = (P2 * (1 - P1) ) / ((1 - P2) * P1 ) )
  
  t_iter &lt;- rbind(t_iter, df)
  
  ### Non-coding
  P1 &lt;- nrow(vto[Pathogenicity == &quot;Pathogenic&quot; ]) / nrow(vto)
  P2 &lt;- nrow(vto[Pathogenicity == &quot;Pathogenic&quot; &amp;  var_type == &quot;Non-coding&quot; &amp;  MAE_PVALUE &lt; t]) / 
    (nrow(vto[var_type == &quot;Non-coding&quot; &amp; MAE_PVALUE &lt; t]) +1 )
  
  df &lt;- data.frame(&quot;Type&quot; = &quot;P-value&quot;,
                   &quot;Variant_type&quot; = &quot;Non-coding&quot;,
                   &quot;Threshold&quot; = t,
                   &quot;OddsPath&quot; = (P2 * (1 - P1) ) / ((1 - P2) * P1 ) )
  
  t_iter &lt;- rbind(t_iter, df)
  
  ### Splice
  P1 &lt;- nrow(vto[Pathogenicity == &quot;Pathogenic&quot; ]) / nrow(vto)
  P2 &lt;- nrow(vto[Pathogenicity == &quot;Pathogenic&quot; &amp;  var_type == &quot;Splice&quot; &amp;  MAE_PVALUE &lt; t]) / 
    (nrow(vto[var_type == &quot;Splice&quot; &amp; MAE_PVALUE &lt; t]) +1 )
  
  df &lt;- data.frame(&quot;Type&quot; = &quot;P-value&quot;,
                   &quot;Variant_type&quot; = &quot;Splice&quot;,
                   &quot;Threshold&quot; = t,
                   &quot;OddsPath&quot; = (P2 * (1 - P1) ) / ((1 - P2) * P1 ) )
  
  t_iter &lt;- rbind(t_iter, df)
}
t_iter &lt;- as.data.table(t_iter)
t_iter[  OddsPath &lt;= 2.1 , &quot;Evidence_strength&quot; :=  &quot;Indeterminate&quot; ]
t_iter[  OddsPath &gt; 2.1 , &quot;Evidence_strength&quot; :=  &quot;PS3 supporting&quot; ]
t_iter[  OddsPath &gt; 4.3 , &quot;Evidence_strength&quot; :=  &quot;PS3 moderate&quot; ]
t_iter[  OddsPath &gt; 18.7 , &quot;Evidence_strength&quot; :=  &quot;PS3 strong&quot; ]
t_iter[  OddsPath &gt; 350 , &quot;Evidence_strength&quot; :=  &quot;PS3 very strong&quot; ]
t_iter$Evidence_strength &lt;- factor(t_iter$Evidence_strength, 
                                   levels= c(&quot;Indeterminate&quot;, &quot;PS3 supporting&quot;,
                                             &quot;PS3 moderate&quot;, &quot;PS3 strong&quot;, &quot;PS3 very strong&quot;))


PS_a &lt;- ggplot(t_iter, aes(Threshold, OddsPath))+
  #geom_vline(xintercept = 0)+
  #geom_vline(xintercept = 0.01, linetype = &quot;dashed&quot;)+
  geom_vline(xintercept = 0.05, linetype = &quot;dashed&quot;)+
  
  geom_hline(yintercept = 2.1, linetype = &quot;dashed&quot;)+
  geom_hline(yintercept = 4.3, linetype = &quot;dashed&quot;)+
  geom_hline(yintercept = 18.7, linetype = &quot;dashed&quot;)+
  # geom_hline(yintercept = 350, linetype = &quot;dashed&quot;)+
  
  geom_line(aes(colour = Variant_type), size = 1.1)+
  geom_point(aes(fill = Variant_type, shape = Evidence_strength), size = 3, colour = &quot;grey20&quot;)+
  xlab(&quot;p-value threshold&quot;) + 
  ylab(&quot;Odds of pathogenicity (OddsPath)&quot;) +
  labs(fill = &quot;Variant type&quot;, 
       colour = &quot;Variant type&quot;, 
       shape = &quot;Evidence strength\nequivalent&quot;)+  
  scale_color_brewer(palette = &quot;Pastel2&quot;)+
  scale_fill_brewer(palette = &quot;Pastel2&quot;)+
  guides(fill=FALSE)+
  #scale_x_continuous(breaks= c(0.0001, 0.001, 0.005, 0.01, 0.05)) +
  #scale_x_log10(breaks = trans_breaks(&quot;log10&quot;, function(x) 10^x), labels = trans_format(&quot;log10&quot;, math_format(10^.x)))+
  #scale_x_log10(breaks = c(0.0001, 0.001, 0.005, 0.01, 0.05), labels = c(&quot;0.0001&quot;, &quot;0.001&quot;, &quot;0.005&quot;, &quot;0.01&quot;, &quot;0.05&quot;))+
  scale_x_continuous(trans = trans_reverser(&#39;log10&#39;),breaks = c(0.0001, 0.001,  0.01, 0.05), labels = c(&quot;&lt;0.0001&quot;, &quot;&lt;0.001&quot;, &quot;&lt;0.01&quot;, &quot;&lt;0.05&quot;) ) +
  
  #annotation_logticks(sides = &quot;b&quot;)+
  #scale_fill_manual(values = variant_colors) +
  scale_shape_manual(values = evidence_shape ) +
  theme_classic()+
  theme(axis.title.y= element_text( size=12,  face=&quot;bold&quot;),
        axis.title.x= element_text( size=12,  face=&quot;bold&quot;),
        axis.text.x = element_text(face=&quot;bold&quot;,  size=12),
        axis.text.y= element_text(face=&quot;bold&quot;,  size=12))</code></pre>
<pre class="r"><code>PS_a</code></pre>
<p><img src="Scripts_RNA_seq_MAE_files/figure-html/unnamed-chunk-4-1.png" width="960" /></p>
<pre class="r"><code>#### FDR iteration
thresholds &lt;- seq(0, 1, 0.01)
t_iter &lt;- data.frame()
for (t in thresholds){
  ### All
  P1 &lt;- nrow(vto[Pathogenicity == &quot;Pathogenic&quot; ]) / nrow(vto)
  P2 &lt;- nrow(vto[Pathogenicity == &quot;Pathogenic&quot; &amp;  MAE_PADJ &lt; t]) / 
    (nrow(vto[ MAE_PADJ &lt; t]) +1 )
  
  df &lt;- data.frame(&quot;Type&quot; = &quot;P-value&quot;,
                   &quot;Variant_type&quot; = &quot;All&quot;,
                   &quot;Threshold&quot; = t,
                   &quot;OddsPath&quot; = (P2 * (1 - P1) ) / ((1 - P2) * P1 ) )
  
  t_iter &lt;- rbind(t_iter, df)
  
  ### PTV
  P1 &lt;- nrow(vto[Pathogenicity == &quot;Pathogenic&quot; ]) / nrow(vto)
  P2 &lt;- nrow(vto[Pathogenicity == &quot;Pathogenic&quot; &amp;  var_type == &quot;PTV&quot; &amp;  MAE_PADJ &lt; t]) / 
    (nrow(vto[var_type == &quot;PTV&quot; &amp; MAE_PADJ &lt; t]) +1 )
  
  df &lt;- data.frame(&quot;Type&quot; = &quot;P-value&quot;,
                   &quot;Variant_type&quot; = &quot;PTV&quot;,
                   &quot;Threshold&quot; = t,
                   &quot;OddsPath&quot; = (P2 * (1 - P1) ) / ((1 - P2) * P1 ) )
  
  t_iter &lt;- rbind(t_iter, df)
  
  ### Coding
  P1 &lt;- nrow(vto[Pathogenicity == &quot;Pathogenic&quot; ]) / nrow(vto)
  P2 &lt;- nrow(vto[Pathogenicity == &quot;Pathogenic&quot; &amp;  var_type == &quot;Coding&quot; &amp; MAE_PADJ &lt; t]) / 
    (nrow(vto[var_type == &quot;Coding&quot; &amp; MAE_PADJ &lt; t]) +1 )
  
  df &lt;- data.frame(&quot;Type&quot; = &quot;P-value&quot;,
                   &quot;Variant_type&quot; = &quot;Coding&quot;,
                   &quot;Threshold&quot; = t,
                   &quot;OddsPath&quot; = (P2 * (1 - P1) ) / ((1 - P2) * P1 ) )
  
  t_iter &lt;- rbind(t_iter, df)
  
  ### Non-coding
  P1 &lt;- nrow(vto[Pathogenicity == &quot;Pathogenic&quot; ]) / nrow(vto)
  P2 &lt;- nrow(vto[Pathogenicity == &quot;Pathogenic&quot; &amp;  var_type == &quot;Non-coding&quot; &amp;  MAE_PADJ &lt; t]) / 
    (nrow(vto[var_type == &quot;Non-coding&quot; &amp; MAE_PADJ &lt; t]) +1 )
  
  df &lt;- data.frame(&quot;Type&quot; = &quot;P-value&quot;,
                   &quot;Variant_type&quot; = &quot;Non-coding&quot;,
                   &quot;Threshold&quot; = t,
                   &quot;OddsPath&quot; = (P2 * (1 - P1) ) / ((1 - P2) * P1 ) )
  
  t_iter &lt;- rbind(t_iter, df)
  
  ### Splice
  P1 &lt;- nrow(vto[Pathogenicity == &quot;Pathogenic&quot; ]) / nrow(vto)
  P2 &lt;- nrow(vto[Pathogenicity == &quot;Pathogenic&quot; &amp;  var_type == &quot;Splice&quot; &amp;  MAE_PADJ &lt; t]) / 
    (nrow(vto[var_type == &quot;Splice&quot; &amp; MAE_PADJ &lt; t]) +1 )
  
  df &lt;- data.frame(&quot;Type&quot; = &quot;P-value&quot;,
                   &quot;Variant_type&quot; = &quot;Splice&quot;,
                   &quot;Threshold&quot; = t,
                   &quot;OddsPath&quot; = (P2 * (1 - P1) ) / ((1 - P2) * P1 ) )
  
  t_iter &lt;- rbind(t_iter, df)
}
t_iter &lt;- as.data.table(t_iter)
t_iter[  OddsPath &lt;= 2.1 , &quot;Evidence_strength&quot; :=  &quot;Indeterminate&quot; ]
t_iter[  OddsPath &gt; 2.1 , &quot;Evidence_strength&quot; :=  &quot;PS3 supporting&quot; ]
t_iter[  OddsPath &gt; 4.3 , &quot;Evidence_strength&quot; :=  &quot;PS3 moderate&quot; ]
t_iter[  OddsPath &gt; 18.7 , &quot;Evidence_strength&quot; :=  &quot;PS3 strong&quot; ]
t_iter[  OddsPath &gt; 350 , &quot;Evidence_strength&quot; :=  &quot;PS3 very strong&quot; ]
t_iter$Evidence_strength &lt;- factor(t_iter$Evidence_strength, 
                                   levels= c(&quot;Indeterminate&quot;, &quot;PS3 supporting&quot;,
                                             &quot;PS3 moderate&quot;, &quot;PS3 strong&quot;, &quot;PS3 very strong&quot;))


PS_b &lt;- ggplot(t_iter[Threshold &gt;= 0.05], aes(Threshold, OddsPath))+
  #geom_vline(xintercept = 0)+
  geom_vline(xintercept = 0.05, linetype = &quot;dashed&quot;)+
  
  geom_hline(yintercept = 2.1, linetype = &quot;dashed&quot;)+
  geom_hline(yintercept = 4.3, linetype = &quot;dashed&quot;)+
  geom_hline(yintercept = 18.7, linetype = &quot;dashed&quot;)+
  # geom_hline(yintercept = 350, linetype = &quot;dashed&quot;)+
  
  geom_line(aes(colour = Variant_type), size = 1.1)+
  geom_point(aes(fill = Variant_type, shape = Evidence_strength), size = 3, colour = &quot;grey20&quot;)+
  xlab(&quot;FDR threshold&quot;) + 
  ylab(&quot;Odds of pathogenicity (OddsPath)&quot;) +
  labs(fill = &quot;Variant type&quot;, 
       colour = &quot;Variant type&quot;, 
       shape = &quot;Evidence strength\nequivalent&quot;)+  
  scale_color_brewer(palette = &quot;Pastel2&quot;)+
  scale_fill_brewer(palette = &quot;Pastel2&quot;)+
  guides(fill=FALSE)+
  #scale_fill_manual(values = variant_colors) +
  scale_shape_manual(values = evidence_shape ) +
  scale_x_reverse(breaks= c( 0.05,  0.25, 0.5, 0.75, 1), labels = c( &quot;&lt;0.05&quot;,  &quot;&lt;0.25&quot;, &quot;&lt;0.5&quot;, &quot;&lt;0.75&quot;, &quot;&lt;1&quot;)) +
  theme_classic()+
  theme(axis.title.y= element_text( size=12,  face=&quot;bold&quot;),
        axis.title.x= element_text( size=12,  face=&quot;bold&quot;),
        axis.text.x = element_text(face=&quot;bold&quot;,  size=12),
        axis.text.y= element_text(face=&quot;bold&quot;,  size=12))</code></pre>
<pre class="r"><code>PS_b</code></pre>
<p><img src="Scripts_RNA_seq_MAE_files/figure-html/unnamed-chunk-5-1.png" width="960" /></p>
<pre class="r"><code>##################################################
####### Allele imbalance #########################
##################################################
thresholds &lt;- seq(0, 0.6, 0.1)
vtoX &lt;- vto
vto &lt;- vto[ !(Pathogenicity == &quot;Pathogenic&quot; &amp; MAE_cause == &quot;F&quot;) ]

t_iter &lt;- data.frame()
for (t in thresholds){
  ### All
  P1 &lt;- nrow(vto[Pathogenicity == &quot;Pathogenic&quot; ]) / nrow(vto)
  P2 &lt;- nrow(vto[Pathogenicity == &quot;Pathogenic&quot; &amp; MAE_PVALUE &lt;0.05 &amp; alt_freq &lt; t ]) / 
    (nrow(vto[MAE_PVALUE &lt;0.05 &amp;  alt_freq &lt; t]) +1 )
  
  df &lt;- data.frame(&quot;Type&quot; = &quot;FC&quot;,
                   &quot;Variant_type&quot; = &quot;All&quot;,
                   &quot;Threshold&quot; = t,
                   &quot;OddsPath&quot; = (P2 * (1 - P1) ) / ((1 - P2) * P1 ) )
  
  t_iter &lt;- rbind(t_iter, df)
  
  ### PTV
  P1 &lt;- nrow(vto[Pathogenicity == &quot;Pathogenic&quot; ]) / nrow(vto)
  P2 &lt;- nrow(vto[Pathogenicity == &quot;Pathogenic&quot; &amp;  var_type == &quot;PTV&quot; &amp; MAE_PVALUE &lt;0.05 &amp;  alt_freq &lt; t]) / 
    (nrow(vto[var_type == &quot;PTV&quot; &amp; MAE_PVALUE &lt;0.05 &amp; alt_freq &lt; t]) +1 )
  
  df &lt;- data.frame(&quot;Type&quot; = &quot;FC&quot;,
                   &quot;Variant_type&quot; = &quot;PTV&quot;,
                   &quot;Threshold&quot; = t,
                   &quot;OddsPath&quot; = (P2 * (1 - P1) ) / ((1 - P2) * P1 ) )
  
  t_iter &lt;- rbind(t_iter, df)
  
  ### Coding
  P1 &lt;- nrow(vto[Pathogenicity == &quot;Pathogenic&quot; ]) / nrow(vto)
  P2 &lt;- nrow(vto[Pathogenicity == &quot;Pathogenic&quot; &amp;  var_type == &quot;Coding&quot; &amp; MAE_PVALUE &lt;0.05 &amp;  alt_freq &lt; t]) / 
    (nrow(vto[var_type == &quot;Coding&quot; &amp; MAE_PVALUE &lt;0.05 &amp; alt_freq &lt; t]) +1 )
  
  df &lt;- data.frame(&quot;Type&quot; = &quot;FC&quot;,
                   &quot;Variant_type&quot; = &quot;Coding&quot;,
                   &quot;Threshold&quot; = t,
                   &quot;OddsPath&quot; = (P2 * (1 - P1) ) / ((1 - P2) * P1 ) )
  
  t_iter &lt;- rbind(t_iter, df)
  
  ### Non-coding
  P1 &lt;- nrow(vto[Pathogenicity == &quot;Pathogenic&quot; ]) / nrow(vto)
  P2 &lt;- nrow(vto[Pathogenicity == &quot;Pathogenic&quot; &amp;  var_type == &quot;Non-coding&quot; &amp; MAE_PVALUE &lt;0.05 &amp;  alt_freq &lt; t]) / 
    (nrow(vto[var_type == &quot;Non-coding&quot; &amp; MAE_PVALUE &lt;0.05 &amp; alt_freq &lt; t]) +1 )
  
  df &lt;- data.frame(&quot;Type&quot; = &quot;FC&quot;,
                   &quot;Variant_type&quot; = &quot;Non-coding&quot;,
                   &quot;Threshold&quot; = t,
                   &quot;OddsPath&quot; = (P2 * (1 - P1) ) / ((1 - P2) * P1 ) )
  
  t_iter &lt;- rbind(t_iter, df)
  
  ### Splice
  P1 &lt;- nrow(vto[Pathogenicity == &quot;Pathogenic&quot; ]) / nrow(vto)
  P2 &lt;- nrow(vto[Pathogenicity == &quot;Pathogenic&quot; &amp;  var_type == &quot;Splice&quot; &amp;  MAE_PVALUE &lt;0.05 &amp; alt_freq &lt; t]) / 
    (nrow(vto[var_type == &quot;Splice&quot; &amp; MAE_PVALUE &lt;0.05 &amp; alt_freq &lt; t]) +1 )
  
  df &lt;- data.frame(&quot;Type&quot; = &quot;FC&quot;,
                   &quot;Variant_type&quot; = &quot;Splice&quot;,
                   &quot;Threshold&quot; = t,
                   &quot;OddsPath&quot; = (P2 * (1 - P1) ) / ((1 - P2) * P1 ) )
  
  t_iter &lt;- rbind(t_iter, df)
}
t_iter &lt;- as.data.table(t_iter)
t_iter[  OddsPath &lt;= 2.1 , &quot;Evidence_strength&quot; :=  &quot;Indeterminate&quot; ]
t_iter[  OddsPath &gt; 2.1 , &quot;Evidence_strength&quot; :=  &quot;PS3 supporting&quot; ]
t_iter[  OddsPath &gt; 4.3 , &quot;Evidence_strength&quot; :=  &quot;PS3 moderate&quot; ]
t_iter[  OddsPath &gt; 18.7 , &quot;Evidence_strength&quot; :=  &quot;PS3 strong&quot; ]
t_iter[  OddsPath &gt; 350 , &quot;Evidence_strength&quot; :=  &quot;PS3 very strong&quot; ]
t_iter$Evidence_strength &lt;- factor(t_iter$Evidence_strength, 
                                   levels= c(&quot;Indeterminate&quot;, &quot;PS3 supporting&quot;,
                                             &quot;PS3 moderate&quot;, &quot;PS3 strong&quot;, &quot;PS3 very strong&quot;))

p1 &lt;- ggplot(vto, aes(var_type, alt_freq) )+
  geom_quasirandom(aes(fill = Pathogenicity, shape = genotype, size = Significance), color = &quot;grey20&quot;)+
  scale_shape_manual(values = gene_shapes, guide = guide_legend(override.aes = list(fill = &quot;black&quot;, size = 3, order = 1)) ) +
  scale_fill_manual(values = outlier_colors, guide = guide_legend(override.aes = list(shape = 23, size = 3, order = 2))) +
  scale_size_manual(values = gene_size) +
  xlab(&quot;&quot;) + 
  ylab(&quot;Alternative allele ratio&quot;) +
  labs(fill = &quot;Pathogenicity&quot;, 
       size = &quot;Significance&quot;,
       shape = &quot;Genotype&quot;)+  
  geom_hline(yintercept = 0.5)+
  #geom_hline(yintercept = 0.5, linetype = &quot;dashed&quot;)+
  theme_classic()+
  theme(axis.title.y= element_text( size=12,  face=&quot;bold&quot;),
        axis.title.x= element_text( size=12,  face=&quot;bold&quot;),
        axis.text.x = element_text(face=&quot;bold&quot;,  size=12),
        axis.text.y= element_text(face=&quot;bold&quot;,  size=12))</code></pre>
<pre class="r"><code>p1</code></pre>
<p><img src="Scripts_RNA_seq_MAE_files/figure-html/unnamed-chunk-6-1.png" width="960" /></p>
<pre class="r"><code>p2 &lt;- ggplot(t_iter[Threshold &gt; 0.1 &amp; Threshold &lt; 0.6], aes(Threshold, OddsPath))+
  #geom_vline(xintercept = 1)+
  
  geom_hline(yintercept = 2.1, linetype = &quot;dashed&quot;)+
  geom_hline(yintercept = 4.3, linetype = &quot;dashed&quot;)+
  geom_hline(yintercept = 18.7, linetype = &quot;dashed&quot;)+
  # geom_hline(yintercept = 350, linetype = &quot;dashed&quot;)+
  
  geom_line(aes(colour = Variant_type),size = 1.1)+
  geom_point(aes(fill = Variant_type, shape = Evidence_strength), size = 3, colour = &quot;grey20&quot;)+
  xlab(&quot;alternative allele ratio threshold of nominally significant MAE&quot;) + 
  ylab(&quot;Odds of pathogenicity (OddsPath)&quot;) +
  labs(fill = &quot;Variant type&quot;, 
       colour = &quot;Variant type&quot;, 
       shape = &quot;Evidence strength\nequivalent&quot;)+  
  scale_color_brewer(palette = &quot;Pastel2&quot;)+
  scale_fill_brewer(palette = &quot;Pastel2&quot;)+
  #scale_fill_manual(values = variant_colors) +
  scale_shape_manual(values = evidence_shape ) +
  scale_x_reverse(breaks= c( 0.1, 0.2, 0.3, 0.4, 0.5), labels = c( &quot;&lt;0.1&quot;, &quot;&lt;0.2&quot;, &quot;&lt;0.3&quot;, &quot;&lt;0.4&quot;, &quot;&lt;0.5&quot;)) +
  guides(fill=FALSE)+
  
  theme_classic()+
  theme(axis.title.y= element_text( size=12,  face=&quot;bold&quot;),
        axis.title.x= element_text( size=12,  face=&quot;bold&quot;),
        axis.text.x = element_text(face=&quot;bold&quot;,  size=12),
        axis.text.y= element_text(face=&quot;bold&quot;,  size=12))</code></pre>
<pre class="r"><code>p2</code></pre>
<p><img src="Scripts_RNA_seq_MAE_files/figure-html/unnamed-chunk-7-1.png" width="960" /></p>
<p>Supp figure paper</p>
<pre class="r"><code>sup_mae &lt;-  ( PS_a  | p2 ) + plot_layout(guides = &#39;collect&#39;) + plot_annotation(tag_levels = &#39;a&#39;) &amp; 
  theme(plot.tag = element_text( size=14,  face=&quot;bold&quot;))</code></pre>
<pre class="r"><code>sup_mae</code></pre>
<p><img src="Scripts_RNA_seq_MAE_files/figure-html/unnamed-chunk-9-1.png" width="960" /></p>

<div id="rmd-source-code">IyctLS0KIycgdGl0bGU6IE9kZHNQYXRoIGZvciBtb25vLWFsbGVsaWMgZXhwcmVzc2lvbgojJyBhdXRob3I6IERtaXRyaWkgU21pcm5vdgojJyB3YjoKIycgIGlucHV0OgojJyAgLSBjb25maWc6ICdzcmMvY29uZmlnLlInCiMnICAtIHNhOiAnYHNtIGNvbmZpZ1siUk5BX0FOTk9UQVRJT04iXWAnCiMnICBvdXRwdXQ6CiMnIG91dHB1dDogCiMnICAgaHRtbF9kb2N1bWVudDoKIycgICAgY29kZV9mb2xkaW5nOiBoaWRlCiMnICAgIGNvZGVfZG93bmxvYWQ6IFRSVUUKIyctLS0KCgpzb3VyY2Uoc25ha2VtYWtlQGlucHV0JGNvbmZpZykKIyBzb3VyY2UoJ3NyYy9jb25maWcuUicpCgoKdnRvIDwtIGZyZWFkKCdkYXRhL01BRV9QX0JfdmFyaWFudHMuY3N2JykKCiN0YWJsZSh2dG9bLCAuKHZhcl90eXBlLCBQYXRob2dlbmljaXR5KV0pCiN0YWJsZSh2dG9bUGF0aG9nZW5pY2l0eSA9PSAiUGF0aG9nZW5pYyIsIC4odmFyX3R5cGUsIE1BRV9jYXVzZSldKQoKCiN1bmlxdWVOKHZ0byRSTkFfSUQpICMxMTQKI3VuaXF1ZU4odnRvW1BhdGhvZ2VuaWNpdHkgPT0gIlBhdGhvZ2VuaWMiXSRSTkFfSUQpICM0MgoKI3VuaXF1ZU4odnRvJGdlbmVJRCkgIzE0MAojdW5pcXVlTih2dG9bUGF0aG9nZW5pY2l0eSA9PSAiUGF0aG9nZW5pYyJdJGdlbmVJRCkgIyAzNwojbnJvdyh2dG9bUGF0aG9nZW5pY2l0eSA9PSAiUGF0aG9nZW5pYyJdKSAjNzQKCgptYWVfY29sb3JzIDwtIGMoICAiQmVuaWduIiA9ICJncmF5ODAiLAogICAgICAgICAgICAgICAgICAiUGF0aG9nZW5pYyIgPSAiI0MyN0JBMCIsCiAgICAgICAgICAgICAgICAgICJPdmVycmVwcmVzZW50ZWQiPSAiIzgwQ0VFMSIsCiAgICAgICAgICAgICAgICAgICJVbmRlcnJlcHJlc2VudGVkIiA9ICIjQ0FFN0MxIiwKICAgICAgICAgICAgICAgICAgIk5vIHJhcmUgdmFyaWFudCI9ICJncmF5ODAiKQoKdnRvWyAsIFBhdGhvZ2VuaWNpdHkyIDo9IFBhdGhvZ2VuaWNpdHldCnZ0b1tQYXRob2dlbmljaXR5ID09ICJQYXRob2dlbmljIiAmIE1BRV9jYXVzZSA9PSAiRiIgLCBQYXRob2dlbmljaXR5MiA6PSAiT3ZlcnJlcHJlc2VudGVkIl0gIyBibHVlCnZ0b1tQYXRob2dlbmljaXR5ID09ICJQYXRob2dlbmljIiAmIE1BRV9jYXVzZSA9PSAiVCIgLCBQYXRob2dlbmljaXR5MiA6PSAiVW5kZXJyZXByZXNlbnRlZCJdICMgZ3JlZW4gCgoKIycgMQoKRmlnNSA8LSBnZ3Bsb3QodnRvLCBhZXModmFyX3R5cGUsIGFsdF9mcmVxKSApKwogIGdlb21fcXVhc2lyYW5kb20oZGF0YT0gdnRvW1BhdGhvZ2VuaWNpdHkgPT0gIkJlbmlnbiIgXSxhZXModmFyX3R5cGUsIGFsdF9mcmVxLCBmaWxsID0gUGF0aG9nZW5pY2l0eTIsIHNoYXBlID0gZ2Vub3R5cGUsIHNpemUgPSBTaWduaWZpY2FuY2UpLCBjb2xvciA9ICJncmV5MjAiKSsKICBnZW9tX3F1YXNpcmFuZG9tKGRhdGE9IHZ0b1tQYXRob2dlbmljaXR5ID09ICJQYXRob2dlbmljIiBdLGFlcyh2YXJfdHlwZSwgYWx0X2ZyZXEsIGZpbGwgPSBQYXRob2dlbmljaXR5Miwgc2hhcGUgPSBnZW5vdHlwZSwgc2l6ZSA9IFNpZ25pZmljYW5jZSksIGNvbG9yID0gImdyZXkyMCIpKwogIHNjYWxlX3NoYXBlX21hbnVhbCh2YWx1ZXMgPSBnZW5lX3NoYXBlcywgZ3VpZGUgPSBndWlkZV9sZWdlbmQob3ZlcnJpZGUuYWVzID0gbGlzdChmaWxsID0gImJsYWNrIiwgc2l6ZSA9IDMsIG9yZGVyID0gMSkpICkgKwogIHNjYWxlX2ZpbGxfbWFudWFsKHZhbHVlcyA9IG1hZV9jb2xvcnMsIGd1aWRlID0gZ3VpZGVfbGVnZW5kKG92ZXJyaWRlLmFlcyA9IGxpc3Qoc2hhcGUgPSAyMywgc2l6ZSA9IDMsIG9yZGVyID0gMikpKSArCiAgc2NhbGVfc2l6ZV9tYW51YWwodmFsdWVzID0gZ2VuZV9zaXplKSArCiAgeGxhYigiIikgKyAKICB5bGFiKCJBbHRlcm5hdGl2ZSBhbGxlbGUgcmF0aW8iKSArCiAgbGFicyhmaWxsID0gIlBhdGhvZ2VuaWNpdHkiLCAKICAgICAgIHNpemUgPSAiU2lnbmlmaWNhbmNlIiwKICAgICAgIHNoYXBlID0gIkdlbm90eXBlIikrICAKICBnZW9tX2hsaW5lKHlpbnRlcmNlcHQgPSAwLjUpKwogIGdlb21faGxpbmUoeWludGVyY2VwdCA9IDAuMiwgbGluZXR5cGUgPSAiZGFzaGVkIikrCiAgZ2VvbV9obGluZSh5aW50ZXJjZXB0ID0gMC44LCBsaW5ldHlwZSA9ICJkYXNoZWQiKSsKICB0aGVtZV9jbGFzc2ljKCkrCiAgdGhlbWUoYXhpcy50aXRsZS55PSBlbGVtZW50X3RleHQoIHNpemU9MTIsICBmYWNlPSJib2xkIiksCiAgICAgICAgYXhpcy50aXRsZS54PSBlbGVtZW50X3RleHQoIHNpemU9MTIsICBmYWNlPSJib2xkIiksCiAgICAgICAgYXhpcy50ZXh0LnggPSBlbGVtZW50X3RleHQoZmFjZT0iYm9sZCIsICBzaXplPTEyKSwKICAgICAgICBheGlzLnRleHQueT0gZWxlbWVudF90ZXh0KGZhY2U9ImJvbGQiLCAgc2l6ZT0xMikpCgojKyBmaWcud2lkdGg9MTAsIGZpZy5oZWlnaHQ9NwpGaWc1CgoKCgojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKIyMjIyMgUC12YWx1ZQojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwoKIyMjIyBQLXZhbHVlIGl0ZXJhdGlvbgojdGhyZXNob2xkcyA8LSBzZXEoMCwgMC4wNSwgMC4wMDEpCgp0aHJlc2hvbGRzIDwtIGMoMC4wMDAxLDAuMDAwNSwgMC4wMDEsIDAuMDA1LCAwLjAxLCAwLjA1KQp0X2l0ZXIgPC0gZGF0YS5mcmFtZSgpCmZvciAodCBpbiB0aHJlc2hvbGRzKXsKICAjIyMgQWxsCiAgUDEgPC0gbnJvdyh2dG9bUGF0aG9nZW5pY2l0eSA9PSAiUGF0aG9nZW5pYyIgXSkgLyBucm93KHZ0bykKICBQMiA8LSBucm93KHZ0b1tQYXRob2dlbmljaXR5ID09ICJQYXRob2dlbmljIiAmICBNQUVfUFZBTFVFIDwgdF0pIC8gCiAgICAobnJvdyh2dG9bIE1BRV9QVkFMVUUgPCB0XSkgKzEgKQogIAogIGRmIDwtIGRhdGEuZnJhbWUoIlR5cGUiID0gIlAtdmFsdWUiLAogICAgICAgICAgICAgICAgICAgIlZhcmlhbnRfdHlwZSIgPSAiQWxsIiwKICAgICAgICAgICAgICAgICAgICJUaHJlc2hvbGQiID0gdCwKICAgICAgICAgICAgICAgICAgICJPZGRzUGF0aCIgPSAoUDIgKiAoMSAtIFAxKSApIC8gKCgxIC0gUDIpICogUDEgKSApCiAgCiAgdF9pdGVyIDwtIHJiaW5kKHRfaXRlciwgZGYpCiAgCiAgIyMjIFBUVgogIFAxIDwtIG5yb3codnRvW1BhdGhvZ2VuaWNpdHkgPT0gIlBhdGhvZ2VuaWMiIF0pIC8gbnJvdyh2dG8pCiAgUDIgPC0gbnJvdyh2dG9bUGF0aG9nZW5pY2l0eSA9PSAiUGF0aG9nZW5pYyIgJiAgdmFyX3R5cGUgPT0gIlBUViIgJiAgTUFFX1BWQUxVRSA8IHRdKSAvIAogICAgKG5yb3codnRvW3Zhcl90eXBlID09ICJQVFYiICYgTUFFX1BWQUxVRSA8IHRdKSArMSApCiAgCiAgZGYgPC0gZGF0YS5mcmFtZSgiVHlwZSIgPSAiUC12YWx1ZSIsCiAgICAgICAgICAgICAgICAgICAiVmFyaWFudF90eXBlIiA9ICJQVFYiLAogICAgICAgICAgICAgICAgICAgIlRocmVzaG9sZCIgPSB0LAogICAgICAgICAgICAgICAgICAgIk9kZHNQYXRoIiA9IChQMiAqICgxIC0gUDEpICkgLyAoKDEgLSBQMikgKiBQMSApICkKICAKICB0X2l0ZXIgPC0gcmJpbmQodF9pdGVyLCBkZikKICAKICAjIyMgQ29kaW5nCiAgUDEgPC0gbnJvdyh2dG9bUGF0aG9nZW5pY2l0eSA9PSAiUGF0aG9nZW5pYyIgXSkgLyBucm93KHZ0bykKICBQMiA8LSBucm93KHZ0b1tQYXRob2dlbmljaXR5ID09ICJQYXRob2dlbmljIiAmICB2YXJfdHlwZSA9PSAiQ29kaW5nIiAmIE1BRV9QVkFMVUUgPCB0XSkgLyAKICAgIChucm93KHZ0b1t2YXJfdHlwZSA9PSAiQ29kaW5nIiAmIE1BRV9QVkFMVUUgPCB0XSkgKzEgKQogIAogIGRmIDwtIGRhdGEuZnJhbWUoIlR5cGUiID0gIlAtdmFsdWUiLAogICAgICAgICAgICAgICAgICAgIlZhcmlhbnRfdHlwZSIgPSAiQ29kaW5nIiwKICAgICAgICAgICAgICAgICAgICJUaHJlc2hvbGQiID0gdCwKICAgICAgICAgICAgICAgICAgICJPZGRzUGF0aCIgPSAoUDIgKiAoMSAtIFAxKSApIC8gKCgxIC0gUDIpICogUDEgKSApCiAgCiAgdF9pdGVyIDwtIHJiaW5kKHRfaXRlciwgZGYpCiAgCiAgIyMjIE5vbi1jb2RpbmcKICBQMSA8LSBucm93KHZ0b1tQYXRob2dlbmljaXR5ID09ICJQYXRob2dlbmljIiBdKSAvIG5yb3codnRvKQogIFAyIDwtIG5yb3codnRvW1BhdGhvZ2VuaWNpdHkgPT0gIlBhdGhvZ2VuaWMiICYgIHZhcl90eXBlID09ICJOb24tY29kaW5nIiAmICBNQUVfUFZBTFVFIDwgdF0pIC8gCiAgICAobnJvdyh2dG9bdmFyX3R5cGUgPT0gIk5vbi1jb2RpbmciICYgTUFFX1BWQUxVRSA8IHRdKSArMSApCiAgCiAgZGYgPC0gZGF0YS5mcmFtZSgiVHlwZSIgPSAiUC12YWx1ZSIsCiAgICAgICAgICAgICAgICAgICAiVmFyaWFudF90eXBlIiA9ICJOb24tY29kaW5nIiwKICAgICAgICAgICAgICAgICAgICJUaHJlc2hvbGQiID0gdCwKICAgICAgICAgICAgICAgICAgICJPZGRzUGF0aCIgPSAoUDIgKiAoMSAtIFAxKSApIC8gKCgxIC0gUDIpICogUDEgKSApCiAgCiAgdF9pdGVyIDwtIHJiaW5kKHRfaXRlciwgZGYpCiAgCiAgIyMjIFNwbGljZQogIFAxIDwtIG5yb3codnRvW1BhdGhvZ2VuaWNpdHkgPT0gIlBhdGhvZ2VuaWMiIF0pIC8gbnJvdyh2dG8pCiAgUDIgPC0gbnJvdyh2dG9bUGF0aG9nZW5pY2l0eSA9PSAiUGF0aG9nZW5pYyIgJiAgdmFyX3R5cGUgPT0gIlNwbGljZSIgJiAgTUFFX1BWQUxVRSA8IHRdKSAvIAogICAgKG5yb3codnRvW3Zhcl90eXBlID09ICJTcGxpY2UiICYgTUFFX1BWQUxVRSA8IHRdKSArMSApCiAgCiAgZGYgPC0gZGF0YS5mcmFtZSgiVHlwZSIgPSAiUC12YWx1ZSIsCiAgICAgICAgICAgICAgICAgICAiVmFyaWFudF90eXBlIiA9ICJTcGxpY2UiLAogICAgICAgICAgICAgICAgICAgIlRocmVzaG9sZCIgPSB0LAogICAgICAgICAgICAgICAgICAgIk9kZHNQYXRoIiA9IChQMiAqICgxIC0gUDEpICkgLyAoKDEgLSBQMikgKiBQMSApICkKICAKICB0X2l0ZXIgPC0gcmJpbmQodF9pdGVyLCBkZikKfQp0X2l0ZXIgPC0gYXMuZGF0YS50YWJsZSh0X2l0ZXIpCnRfaXRlclsgIE9kZHNQYXRoIDw9IDIuMSAsICJFdmlkZW5jZV9zdHJlbmd0aCIgOj0gICJJbmRldGVybWluYXRlIiBdCnRfaXRlclsgIE9kZHNQYXRoID4gMi4xICwgIkV2aWRlbmNlX3N0cmVuZ3RoIiA6PSAgIlBTMyBzdXBwb3J0aW5nIiBdCnRfaXRlclsgIE9kZHNQYXRoID4gNC4zICwgIkV2aWRlbmNlX3N0cmVuZ3RoIiA6PSAgIlBTMyBtb2RlcmF0ZSIgXQp0X2l0ZXJbICBPZGRzUGF0aCA+IDE4LjcgLCAiRXZpZGVuY2Vfc3RyZW5ndGgiIDo9ICAiUFMzIHN0cm9uZyIgXQp0X2l0ZXJbICBPZGRzUGF0aCA+IDM1MCAsICJFdmlkZW5jZV9zdHJlbmd0aCIgOj0gICJQUzMgdmVyeSBzdHJvbmciIF0KdF9pdGVyJEV2aWRlbmNlX3N0cmVuZ3RoIDwtIGZhY3Rvcih0X2l0ZXIkRXZpZGVuY2Vfc3RyZW5ndGgsIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldmVscz0gYygiSW5kZXRlcm1pbmF0ZSIsICJQUzMgc3VwcG9ydGluZyIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJQUzMgbW9kZXJhdGUiLCAiUFMzIHN0cm9uZyIsICJQUzMgdmVyeSBzdHJvbmciKSkKCgpQU19hIDwtIGdncGxvdCh0X2l0ZXIsIGFlcyhUaHJlc2hvbGQsIE9kZHNQYXRoKSkrCiAgI2dlb21fdmxpbmUoeGludGVyY2VwdCA9IDApKwogICNnZW9tX3ZsaW5lKHhpbnRlcmNlcHQgPSAwLjAxLCBsaW5ldHlwZSA9ICJkYXNoZWQiKSsKICBnZW9tX3ZsaW5lKHhpbnRlcmNlcHQgPSAwLjA1LCBsaW5ldHlwZSA9ICJkYXNoZWQiKSsKICAKICBnZW9tX2hsaW5lKHlpbnRlcmNlcHQgPSAyLjEsIGxpbmV0eXBlID0gImRhc2hlZCIpKwogIGdlb21faGxpbmUoeWludGVyY2VwdCA9IDQuMywgbGluZXR5cGUgPSAiZGFzaGVkIikrCiAgZ2VvbV9obGluZSh5aW50ZXJjZXB0ID0gMTguNywgbGluZXR5cGUgPSAiZGFzaGVkIikrCiAgIyBnZW9tX2hsaW5lKHlpbnRlcmNlcHQgPSAzNTAsIGxpbmV0eXBlID0gImRhc2hlZCIpKwogIAogIGdlb21fbGluZShhZXMoY29sb3VyID0gVmFyaWFudF90eXBlKSwgc2l6ZSA9IDEuMSkrCiAgZ2VvbV9wb2ludChhZXMoZmlsbCA9IFZhcmlhbnRfdHlwZSwgc2hhcGUgPSBFdmlkZW5jZV9zdHJlbmd0aCksIHNpemUgPSAzLCBjb2xvdXIgPSAiZ3JleTIwIikrCiAgeGxhYigicC12YWx1ZSB0aHJlc2hvbGQiKSArIAogIHlsYWIoIk9kZHMgb2YgcGF0aG9nZW5pY2l0eSAoT2Rkc1BhdGgpIikgKwogIGxhYnMoZmlsbCA9ICJWYXJpYW50IHR5cGUiLCAKICAgICAgIGNvbG91ciA9ICJWYXJpYW50IHR5cGUiLCAKICAgICAgIHNoYXBlID0gIkV2aWRlbmNlIHN0cmVuZ3RoXG5lcXVpdmFsZW50IikrICAKICBzY2FsZV9jb2xvcl9icmV3ZXIocGFsZXR0ZSA9ICJQYXN0ZWwyIikrCiAgc2NhbGVfZmlsbF9icmV3ZXIocGFsZXR0ZSA9ICJQYXN0ZWwyIikrCiAgZ3VpZGVzKGZpbGw9RkFMU0UpKwogICNzY2FsZV94X2NvbnRpbnVvdXMoYnJlYWtzPSBjKDAuMDAwMSwgMC4wMDEsIDAuMDA1LCAwLjAxLCAwLjA1KSkgKwogICNzY2FsZV94X2xvZzEwKGJyZWFrcyA9IHRyYW5zX2JyZWFrcygibG9nMTAiLCBmdW5jdGlvbih4KSAxMF54KSwgbGFiZWxzID0gdHJhbnNfZm9ybWF0KCJsb2cxMCIsIG1hdGhfZm9ybWF0KDEwXi54KSkpKwogICNzY2FsZV94X2xvZzEwKGJyZWFrcyA9IGMoMC4wMDAxLCAwLjAwMSwgMC4wMDUsIDAuMDEsIDAuMDUpLCBsYWJlbHMgPSBjKCIwLjAwMDEiLCAiMC4wMDEiLCAiMC4wMDUiLCAiMC4wMSIsICIwLjA1IikpKwogIHNjYWxlX3hfY29udGludW91cyh0cmFucyA9IHRyYW5zX3JldmVyc2VyKCdsb2cxMCcpLGJyZWFrcyA9IGMoMC4wMDAxLCAwLjAwMSwgIDAuMDEsIDAuMDUpLCBsYWJlbHMgPSBjKCI8MC4wMDAxIiwgIjwwLjAwMSIsICI8MC4wMSIsICI8MC4wNSIpICkgKwogIAogICNhbm5vdGF0aW9uX2xvZ3RpY2tzKHNpZGVzID0gImIiKSsKICAjc2NhbGVfZmlsbF9tYW51YWwodmFsdWVzID0gdmFyaWFudF9jb2xvcnMpICsKICBzY2FsZV9zaGFwZV9tYW51YWwodmFsdWVzID0gZXZpZGVuY2Vfc2hhcGUgKSArCiAgdGhlbWVfY2xhc3NpYygpKwogIHRoZW1lKGF4aXMudGl0bGUueT0gZWxlbWVudF90ZXh0KCBzaXplPTEyLCAgZmFjZT0iYm9sZCIpLAogICAgICAgIGF4aXMudGl0bGUueD0gZWxlbWVudF90ZXh0KCBzaXplPTEyLCAgZmFjZT0iYm9sZCIpLAogICAgICAgIGF4aXMudGV4dC54ID0gZWxlbWVudF90ZXh0KGZhY2U9ImJvbGQiLCAgc2l6ZT0xMiksCiAgICAgICAgYXhpcy50ZXh0Lnk9IGVsZW1lbnRfdGV4dChmYWNlPSJib2xkIiwgIHNpemU9MTIpKQoKIysgZmlnLndpZHRoPTEwLCBmaWcuaGVpZ2h0PTcKUFNfYQoKIyMjIyBGRFIgaXRlcmF0aW9uCnRocmVzaG9sZHMgPC0gc2VxKDAsIDEsIDAuMDEpCnRfaXRlciA8LSBkYXRhLmZyYW1lKCkKZm9yICh0IGluIHRocmVzaG9sZHMpewogICMjIyBBbGwKICBQMSA8LSBucm93KHZ0b1tQYXRob2dlbmljaXR5ID09ICJQYXRob2dlbmljIiBdKSAvIG5yb3codnRvKQogIFAyIDwtIG5yb3codnRvW1BhdGhvZ2VuaWNpdHkgPT0gIlBhdGhvZ2VuaWMiICYgIE1BRV9QQURKIDwgdF0pIC8gCiAgICAobnJvdyh2dG9bIE1BRV9QQURKIDwgdF0pICsxICkKICAKICBkZiA8LSBkYXRhLmZyYW1lKCJUeXBlIiA9ICJQLXZhbHVlIiwKICAgICAgICAgICAgICAgICAgICJWYXJpYW50X3R5cGUiID0gIkFsbCIsCiAgICAgICAgICAgICAgICAgICAiVGhyZXNob2xkIiA9IHQsCiAgICAgICAgICAgICAgICAgICAiT2Rkc1BhdGgiID0gKFAyICogKDEgLSBQMSkgKSAvICgoMSAtIFAyKSAqIFAxICkgKQogIAogIHRfaXRlciA8LSByYmluZCh0X2l0ZXIsIGRmKQogIAogICMjIyBQVFYKICBQMSA8LSBucm93KHZ0b1tQYXRob2dlbmljaXR5ID09ICJQYXRob2dlbmljIiBdKSAvIG5yb3codnRvKQogIFAyIDwtIG5yb3codnRvW1BhdGhvZ2VuaWNpdHkgPT0gIlBhdGhvZ2VuaWMiICYgIHZhcl90eXBlID09ICJQVFYiICYgIE1BRV9QQURKIDwgdF0pIC8gCiAgICAobnJvdyh2dG9bdmFyX3R5cGUgPT0gIlBUViIgJiBNQUVfUEFESiA8IHRdKSArMSApCiAgCiAgZGYgPC0gZGF0YS5mcmFtZSgiVHlwZSIgPSAiUC12YWx1ZSIsCiAgICAgICAgICAgICAgICAgICAiVmFyaWFudF90eXBlIiA9ICJQVFYiLAogICAgICAgICAgICAgICAgICAgIlRocmVzaG9sZCIgPSB0LAogICAgICAgICAgICAgICAgICAgIk9kZHNQYXRoIiA9IChQMiAqICgxIC0gUDEpICkgLyAoKDEgLSBQMikgKiBQMSApICkKICAKICB0X2l0ZXIgPC0gcmJpbmQodF9pdGVyLCBkZikKICAKICAjIyMgQ29kaW5nCiAgUDEgPC0gbnJvdyh2dG9bUGF0aG9nZW5pY2l0eSA9PSAiUGF0aG9nZW5pYyIgXSkgLyBucm93KHZ0bykKICBQMiA8LSBucm93KHZ0b1tQYXRob2dlbmljaXR5ID09ICJQYXRob2dlbmljIiAmICB2YXJfdHlwZSA9PSAiQ29kaW5nIiAmIE1BRV9QQURKIDwgdF0pIC8gCiAgICAobnJvdyh2dG9bdmFyX3R5cGUgPT0gIkNvZGluZyIgJiBNQUVfUEFESiA8IHRdKSArMSApCiAgCiAgZGYgPC0gZGF0YS5mcmFtZSgiVHlwZSIgPSAiUC12YWx1ZSIsCiAgICAgICAgICAgICAgICAgICAiVmFyaWFudF90eXBlIiA9ICJDb2RpbmciLAogICAgICAgICAgICAgICAgICAgIlRocmVzaG9sZCIgPSB0LAogICAgICAgICAgICAgICAgICAgIk9kZHNQYXRoIiA9IChQMiAqICgxIC0gUDEpICkgLyAoKDEgLSBQMikgKiBQMSApICkKICAKICB0X2l0ZXIgPC0gcmJpbmQodF9pdGVyLCBkZikKICAKICAjIyMgTm9uLWNvZGluZwogIFAxIDwtIG5yb3codnRvW1BhdGhvZ2VuaWNpdHkgPT0gIlBhdGhvZ2VuaWMiIF0pIC8gbnJvdyh2dG8pCiAgUDIgPC0gbnJvdyh2dG9bUGF0aG9nZW5pY2l0eSA9PSAiUGF0aG9nZW5pYyIgJiAgdmFyX3R5cGUgPT0gIk5vbi1jb2RpbmciICYgIE1BRV9QQURKIDwgdF0pIC8gCiAgICAobnJvdyh2dG9bdmFyX3R5cGUgPT0gIk5vbi1jb2RpbmciICYgTUFFX1BBREogPCB0XSkgKzEgKQogIAogIGRmIDwtIGRhdGEuZnJhbWUoIlR5cGUiID0gIlAtdmFsdWUiLAogICAgICAgICAgICAgICAgICAgIlZhcmlhbnRfdHlwZSIgPSAiTm9uLWNvZGluZyIsCiAgICAgICAgICAgICAgICAgICAiVGhyZXNob2xkIiA9IHQsCiAgICAgICAgICAgICAgICAgICAiT2Rkc1BhdGgiID0gKFAyICogKDEgLSBQMSkgKSAvICgoMSAtIFAyKSAqIFAxICkgKQogIAogIHRfaXRlciA8LSByYmluZCh0X2l0ZXIsIGRmKQogIAogICMjIyBTcGxpY2UKICBQMSA8LSBucm93KHZ0b1tQYXRob2dlbmljaXR5ID09ICJQYXRob2dlbmljIiBdKSAvIG5yb3codnRvKQogIFAyIDwtIG5yb3codnRvW1BhdGhvZ2VuaWNpdHkgPT0gIlBhdGhvZ2VuaWMiICYgIHZhcl90eXBlID09ICJTcGxpY2UiICYgIE1BRV9QQURKIDwgdF0pIC8gCiAgICAobnJvdyh2dG9bdmFyX3R5cGUgPT0gIlNwbGljZSIgJiBNQUVfUEFESiA8IHRdKSArMSApCiAgCiAgZGYgPC0gZGF0YS5mcmFtZSgiVHlwZSIgPSAiUC12YWx1ZSIsCiAgICAgICAgICAgICAgICAgICAiVmFyaWFudF90eXBlIiA9ICJTcGxpY2UiLAogICAgICAgICAgICAgICAgICAgIlRocmVzaG9sZCIgPSB0LAogICAgICAgICAgICAgICAgICAgIk9kZHNQYXRoIiA9IChQMiAqICgxIC0gUDEpICkgLyAoKDEgLSBQMikgKiBQMSApICkKICAKICB0X2l0ZXIgPC0gcmJpbmQodF9pdGVyLCBkZikKfQp0X2l0ZXIgPC0gYXMuZGF0YS50YWJsZSh0X2l0ZXIpCnRfaXRlclsgIE9kZHNQYXRoIDw9IDIuMSAsICJFdmlkZW5jZV9zdHJlbmd0aCIgOj0gICJJbmRldGVybWluYXRlIiBdCnRfaXRlclsgIE9kZHNQYXRoID4gMi4xICwgIkV2aWRlbmNlX3N0cmVuZ3RoIiA6PSAgIlBTMyBzdXBwb3J0aW5nIiBdCnRfaXRlclsgIE9kZHNQYXRoID4gNC4zICwgIkV2aWRlbmNlX3N0cmVuZ3RoIiA6PSAgIlBTMyBtb2RlcmF0ZSIgXQp0X2l0ZXJbICBPZGRzUGF0aCA+IDE4LjcgLCAiRXZpZGVuY2Vfc3RyZW5ndGgiIDo9ICAiUFMzIHN0cm9uZyIgXQp0X2l0ZXJbICBPZGRzUGF0aCA+IDM1MCAsICJFdmlkZW5jZV9zdHJlbmd0aCIgOj0gICJQUzMgdmVyeSBzdHJvbmciIF0KdF9pdGVyJEV2aWRlbmNlX3N0cmVuZ3RoIDwtIGZhY3Rvcih0X2l0ZXIkRXZpZGVuY2Vfc3RyZW5ndGgsIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldmVscz0gYygiSW5kZXRlcm1pbmF0ZSIsICJQUzMgc3VwcG9ydGluZyIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJQUzMgbW9kZXJhdGUiLCAiUFMzIHN0cm9uZyIsICJQUzMgdmVyeSBzdHJvbmciKSkKCgpQU19iIDwtIGdncGxvdCh0X2l0ZXJbVGhyZXNob2xkID49IDAuMDVdLCBhZXMoVGhyZXNob2xkLCBPZGRzUGF0aCkpKwogICNnZW9tX3ZsaW5lKHhpbnRlcmNlcHQgPSAwKSsKICBnZW9tX3ZsaW5lKHhpbnRlcmNlcHQgPSAwLjA1LCBsaW5ldHlwZSA9ICJkYXNoZWQiKSsKICAKICBnZW9tX2hsaW5lKHlpbnRlcmNlcHQgPSAyLjEsIGxpbmV0eXBlID0gImRhc2hlZCIpKwogIGdlb21faGxpbmUoeWludGVyY2VwdCA9IDQuMywgbGluZXR5cGUgPSAiZGFzaGVkIikrCiAgZ2VvbV9obGluZSh5aW50ZXJjZXB0ID0gMTguNywgbGluZXR5cGUgPSAiZGFzaGVkIikrCiAgIyBnZW9tX2hsaW5lKHlpbnRlcmNlcHQgPSAzNTAsIGxpbmV0eXBlID0gImRhc2hlZCIpKwogIAogIGdlb21fbGluZShhZXMoY29sb3VyID0gVmFyaWFudF90eXBlKSwgc2l6ZSA9IDEuMSkrCiAgZ2VvbV9wb2ludChhZXMoZmlsbCA9IFZhcmlhbnRfdHlwZSwgc2hhcGUgPSBFdmlkZW5jZV9zdHJlbmd0aCksIHNpemUgPSAzLCBjb2xvdXIgPSAiZ3JleTIwIikrCiAgeGxhYigiRkRSIHRocmVzaG9sZCIpICsgCiAgeWxhYigiT2RkcyBvZiBwYXRob2dlbmljaXR5IChPZGRzUGF0aCkiKSArCiAgbGFicyhmaWxsID0gIlZhcmlhbnQgdHlwZSIsIAogICAgICAgY29sb3VyID0gIlZhcmlhbnQgdHlwZSIsIAogICAgICAgc2hhcGUgPSAiRXZpZGVuY2Ugc3RyZW5ndGhcbmVxdWl2YWxlbnQiKSsgIAogIHNjYWxlX2NvbG9yX2JyZXdlcihwYWxldHRlID0gIlBhc3RlbDIiKSsKICBzY2FsZV9maWxsX2JyZXdlcihwYWxldHRlID0gIlBhc3RlbDIiKSsKICBndWlkZXMoZmlsbD1GQUxTRSkrCiAgI3NjYWxlX2ZpbGxfbWFudWFsKHZhbHVlcyA9IHZhcmlhbnRfY29sb3JzKSArCiAgc2NhbGVfc2hhcGVfbWFudWFsKHZhbHVlcyA9IGV2aWRlbmNlX3NoYXBlICkgKwogIHNjYWxlX3hfcmV2ZXJzZShicmVha3M9IGMoIDAuMDUsICAwLjI1LCAwLjUsIDAuNzUsIDEpLCBsYWJlbHMgPSBjKCAiPDAuMDUiLCAgIjwwLjI1IiwgIjwwLjUiLCAiPDAuNzUiLCAiPDEiKSkgKwogIHRoZW1lX2NsYXNzaWMoKSsKICB0aGVtZShheGlzLnRpdGxlLnk9IGVsZW1lbnRfdGV4dCggc2l6ZT0xMiwgIGZhY2U9ImJvbGQiKSwKICAgICAgICBheGlzLnRpdGxlLng9IGVsZW1lbnRfdGV4dCggc2l6ZT0xMiwgIGZhY2U9ImJvbGQiKSwKICAgICAgICBheGlzLnRleHQueCA9IGVsZW1lbnRfdGV4dChmYWNlPSJib2xkIiwgIHNpemU9MTIpLAogICAgICAgIGF4aXMudGV4dC55PSBlbGVtZW50X3RleHQoZmFjZT0iYm9sZCIsICBzaXplPTEyKSkKCiMrIGZpZy53aWR0aD0xMCwgZmlnLmhlaWdodD03ClBTX2IKCgoKCgoKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKIyMjIyMjIyBBbGxlbGUgaW1iYWxhbmNlICMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKdGhyZXNob2xkcyA8LSBzZXEoMCwgMC42LCAwLjEpCnZ0b1ggPC0gdnRvCnZ0byA8LSB2dG9bICEoUGF0aG9nZW5pY2l0eSA9PSAiUGF0aG9nZW5pYyIgJiBNQUVfY2F1c2UgPT0gIkYiKSBdCgp0X2l0ZXIgPC0gZGF0YS5mcmFtZSgpCmZvciAodCBpbiB0aHJlc2hvbGRzKXsKICAjIyMgQWxsCiAgUDEgPC0gbnJvdyh2dG9bUGF0aG9nZW5pY2l0eSA9PSAiUGF0aG9nZW5pYyIgXSkgLyBucm93KHZ0bykKICBQMiA8LSBucm93KHZ0b1tQYXRob2dlbmljaXR5ID09ICJQYXRob2dlbmljIiAmIE1BRV9QVkFMVUUgPDAuMDUgJiBhbHRfZnJlcSA8IHQgXSkgLyAKICAgIChucm93KHZ0b1tNQUVfUFZBTFVFIDwwLjA1ICYgIGFsdF9mcmVxIDwgdF0pICsxICkKICAKICBkZiA8LSBkYXRhLmZyYW1lKCJUeXBlIiA9ICJGQyIsCiAgICAgICAgICAgICAgICAgICAiVmFyaWFudF90eXBlIiA9ICJBbGwiLAogICAgICAgICAgICAgICAgICAgIlRocmVzaG9sZCIgPSB0LAogICAgICAgICAgICAgICAgICAgIk9kZHNQYXRoIiA9IChQMiAqICgxIC0gUDEpICkgLyAoKDEgLSBQMikgKiBQMSApICkKICAKICB0X2l0ZXIgPC0gcmJpbmQodF9pdGVyLCBkZikKICAKICAjIyMgUFRWCiAgUDEgPC0gbnJvdyh2dG9bUGF0aG9nZW5pY2l0eSA9PSAiUGF0aG9nZW5pYyIgXSkgLyBucm93KHZ0bykKICBQMiA8LSBucm93KHZ0b1tQYXRob2dlbmljaXR5ID09ICJQYXRob2dlbmljIiAmICB2YXJfdHlwZSA9PSAiUFRWIiAmIE1BRV9QVkFMVUUgPDAuMDUgJiAgYWx0X2ZyZXEgPCB0XSkgLyAKICAgIChucm93KHZ0b1t2YXJfdHlwZSA9PSAiUFRWIiAmIE1BRV9QVkFMVUUgPDAuMDUgJiBhbHRfZnJlcSA8IHRdKSArMSApCiAgCiAgZGYgPC0gZGF0YS5mcmFtZSgiVHlwZSIgPSAiRkMiLAogICAgICAgICAgICAgICAgICAgIlZhcmlhbnRfdHlwZSIgPSAiUFRWIiwKICAgICAgICAgICAgICAgICAgICJUaHJlc2hvbGQiID0gdCwKICAgICAgICAgICAgICAgICAgICJPZGRzUGF0aCIgPSAoUDIgKiAoMSAtIFAxKSApIC8gKCgxIC0gUDIpICogUDEgKSApCiAgCiAgdF9pdGVyIDwtIHJiaW5kKHRfaXRlciwgZGYpCiAgCiAgIyMjIENvZGluZwogIFAxIDwtIG5yb3codnRvW1BhdGhvZ2VuaWNpdHkgPT0gIlBhdGhvZ2VuaWMiIF0pIC8gbnJvdyh2dG8pCiAgUDIgPC0gbnJvdyh2dG9bUGF0aG9nZW5pY2l0eSA9PSAiUGF0aG9nZW5pYyIgJiAgdmFyX3R5cGUgPT0gIkNvZGluZyIgJiBNQUVfUFZBTFVFIDwwLjA1ICYgIGFsdF9mcmVxIDwgdF0pIC8gCiAgICAobnJvdyh2dG9bdmFyX3R5cGUgPT0gIkNvZGluZyIgJiBNQUVfUFZBTFVFIDwwLjA1ICYgYWx0X2ZyZXEgPCB0XSkgKzEgKQogIAogIGRmIDwtIGRhdGEuZnJhbWUoIlR5cGUiID0gIkZDIiwKICAgICAgICAgICAgICAgICAgICJWYXJpYW50X3R5cGUiID0gIkNvZGluZyIsCiAgICAgICAgICAgICAgICAgICAiVGhyZXNob2xkIiA9IHQsCiAgICAgICAgICAgICAgICAgICAiT2Rkc1BhdGgiID0gKFAyICogKDEgLSBQMSkgKSAvICgoMSAtIFAyKSAqIFAxICkgKQogIAogIHRfaXRlciA8LSByYmluZCh0X2l0ZXIsIGRmKQogIAogICMjIyBOb24tY29kaW5nCiAgUDEgPC0gbnJvdyh2dG9bUGF0aG9nZW5pY2l0eSA9PSAiUGF0aG9nZW5pYyIgXSkgLyBucm93KHZ0bykKICBQMiA8LSBucm93KHZ0b1tQYXRob2dlbmljaXR5ID09ICJQYXRob2dlbmljIiAmICB2YXJfdHlwZSA9PSAiTm9uLWNvZGluZyIgJiBNQUVfUFZBTFVFIDwwLjA1ICYgIGFsdF9mcmVxIDwgdF0pIC8gCiAgICAobnJvdyh2dG9bdmFyX3R5cGUgPT0gIk5vbi1jb2RpbmciICYgTUFFX1BWQUxVRSA8MC4wNSAmIGFsdF9mcmVxIDwgdF0pICsxICkKICAKICBkZiA8LSBkYXRhLmZyYW1lKCJUeXBlIiA9ICJGQyIsCiAgICAgICAgICAgICAgICAgICAiVmFyaWFudF90eXBlIiA9ICJOb24tY29kaW5nIiwKICAgICAgICAgICAgICAgICAgICJUaHJlc2hvbGQiID0gdCwKICAgICAgICAgICAgICAgICAgICJPZGRzUGF0aCIgPSAoUDIgKiAoMSAtIFAxKSApIC8gKCgxIC0gUDIpICogUDEgKSApCiAgCiAgdF9pdGVyIDwtIHJiaW5kKHRfaXRlciwgZGYpCiAgCiAgIyMjIFNwbGljZQogIFAxIDwtIG5yb3codnRvW1BhdGhvZ2VuaWNpdHkgPT0gIlBhdGhvZ2VuaWMiIF0pIC8gbnJvdyh2dG8pCiAgUDIgPC0gbnJvdyh2dG9bUGF0aG9nZW5pY2l0eSA9PSAiUGF0aG9nZW5pYyIgJiAgdmFyX3R5cGUgPT0gIlNwbGljZSIgJiAgTUFFX1BWQUxVRSA8MC4wNSAmIGFsdF9mcmVxIDwgdF0pIC8gCiAgICAobnJvdyh2dG9bdmFyX3R5cGUgPT0gIlNwbGljZSIgJiBNQUVfUFZBTFVFIDwwLjA1ICYgYWx0X2ZyZXEgPCB0XSkgKzEgKQogIAogIGRmIDwtIGRhdGEuZnJhbWUoIlR5cGUiID0gIkZDIiwKICAgICAgICAgICAgICAgICAgICJWYXJpYW50X3R5cGUiID0gIlNwbGljZSIsCiAgICAgICAgICAgICAgICAgICAiVGhyZXNob2xkIiA9IHQsCiAgICAgICAgICAgICAgICAgICAiT2Rkc1BhdGgiID0gKFAyICogKDEgLSBQMSkgKSAvICgoMSAtIFAyKSAqIFAxICkgKQogIAogIHRfaXRlciA8LSByYmluZCh0X2l0ZXIsIGRmKQp9CnRfaXRlciA8LSBhcy5kYXRhLnRhYmxlKHRfaXRlcikKdF9pdGVyWyAgT2Rkc1BhdGggPD0gMi4xICwgIkV2aWRlbmNlX3N0cmVuZ3RoIiA6PSAgIkluZGV0ZXJtaW5hdGUiIF0KdF9pdGVyWyAgT2Rkc1BhdGggPiAyLjEgLCAiRXZpZGVuY2Vfc3RyZW5ndGgiIDo9ICAiUFMzIHN1cHBvcnRpbmciIF0KdF9pdGVyWyAgT2Rkc1BhdGggPiA0LjMgLCAiRXZpZGVuY2Vfc3RyZW5ndGgiIDo9ICAiUFMzIG1vZGVyYXRlIiBdCnRfaXRlclsgIE9kZHNQYXRoID4gMTguNyAsICJFdmlkZW5jZV9zdHJlbmd0aCIgOj0gICJQUzMgc3Ryb25nIiBdCnRfaXRlclsgIE9kZHNQYXRoID4gMzUwICwgIkV2aWRlbmNlX3N0cmVuZ3RoIiA6PSAgIlBTMyB2ZXJ5IHN0cm9uZyIgXQp0X2l0ZXIkRXZpZGVuY2Vfc3RyZW5ndGggPC0gZmFjdG9yKHRfaXRlciRFdmlkZW5jZV9zdHJlbmd0aCwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV2ZWxzPSBjKCJJbmRldGVybWluYXRlIiwgIlBTMyBzdXBwb3J0aW5nIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlBTMyBtb2RlcmF0ZSIsICJQUzMgc3Ryb25nIiwgIlBTMyB2ZXJ5IHN0cm9uZyIpKQoKcDEgPC0gZ2dwbG90KHZ0bywgYWVzKHZhcl90eXBlLCBhbHRfZnJlcSkgKSsKICBnZW9tX3F1YXNpcmFuZG9tKGFlcyhmaWxsID0gUGF0aG9nZW5pY2l0eSwgc2hhcGUgPSBnZW5vdHlwZSwgc2l6ZSA9IFNpZ25pZmljYW5jZSksIGNvbG9yID0gImdyZXkyMCIpKwogIHNjYWxlX3NoYXBlX21hbnVhbCh2YWx1ZXMgPSBnZW5lX3NoYXBlcywgZ3VpZGUgPSBndWlkZV9sZWdlbmQob3ZlcnJpZGUuYWVzID0gbGlzdChmaWxsID0gImJsYWNrIiwgc2l6ZSA9IDMsIG9yZGVyID0gMSkpICkgKwogIHNjYWxlX2ZpbGxfbWFudWFsKHZhbHVlcyA9IG91dGxpZXJfY29sb3JzLCBndWlkZSA9IGd1aWRlX2xlZ2VuZChvdmVycmlkZS5hZXMgPSBsaXN0KHNoYXBlID0gMjMsIHNpemUgPSAzLCBvcmRlciA9IDIpKSkgKwogIHNjYWxlX3NpemVfbWFudWFsKHZhbHVlcyA9IGdlbmVfc2l6ZSkgKwogIHhsYWIoIiIpICsgCiAgeWxhYigiQWx0ZXJuYXRpdmUgYWxsZWxlIHJhdGlvIikgKwogIGxhYnMoZmlsbCA9ICJQYXRob2dlbmljaXR5IiwgCiAgICAgICBzaXplID0gIlNpZ25pZmljYW5jZSIsCiAgICAgICBzaGFwZSA9ICJHZW5vdHlwZSIpKyAgCiAgZ2VvbV9obGluZSh5aW50ZXJjZXB0ID0gMC41KSsKICAjZ2VvbV9obGluZSh5aW50ZXJjZXB0ID0gMC41LCBsaW5ldHlwZSA9ICJkYXNoZWQiKSsKICB0aGVtZV9jbGFzc2ljKCkrCiAgdGhlbWUoYXhpcy50aXRsZS55PSBlbGVtZW50X3RleHQoIHNpemU9MTIsICBmYWNlPSJib2xkIiksCiAgICAgICAgYXhpcy50aXRsZS54PSBlbGVtZW50X3RleHQoIHNpemU9MTIsICBmYWNlPSJib2xkIiksCiAgICAgICAgYXhpcy50ZXh0LnggPSBlbGVtZW50X3RleHQoZmFjZT0iYm9sZCIsICBzaXplPTEyKSwKICAgICAgICBheGlzLnRleHQueT0gZWxlbWVudF90ZXh0KGZhY2U9ImJvbGQiLCAgc2l6ZT0xMikpCgojKyBmaWcud2lkdGg9MTAsIGZpZy5oZWlnaHQ9NwpwMQoKCnAyIDwtIGdncGxvdCh0X2l0ZXJbVGhyZXNob2xkID4gMC4xICYgVGhyZXNob2xkIDwgMC42XSwgYWVzKFRocmVzaG9sZCwgT2Rkc1BhdGgpKSsKICAjZ2VvbV92bGluZSh4aW50ZXJjZXB0ID0gMSkrCiAgCiAgZ2VvbV9obGluZSh5aW50ZXJjZXB0ID0gMi4xLCBsaW5ldHlwZSA9ICJkYXNoZWQiKSsKICBnZW9tX2hsaW5lKHlpbnRlcmNlcHQgPSA0LjMsIGxpbmV0eXBlID0gImRhc2hlZCIpKwogIGdlb21faGxpbmUoeWludGVyY2VwdCA9IDE4LjcsIGxpbmV0eXBlID0gImRhc2hlZCIpKwogICMgZ2VvbV9obGluZSh5aW50ZXJjZXB0ID0gMzUwLCBsaW5ldHlwZSA9ICJkYXNoZWQiKSsKICAKICBnZW9tX2xpbmUoYWVzKGNvbG91ciA9IFZhcmlhbnRfdHlwZSksc2l6ZSA9IDEuMSkrCiAgZ2VvbV9wb2ludChhZXMoZmlsbCA9IFZhcmlhbnRfdHlwZSwgc2hhcGUgPSBFdmlkZW5jZV9zdHJlbmd0aCksIHNpemUgPSAzLCBjb2xvdXIgPSAiZ3JleTIwIikrCiAgeGxhYigiYWx0ZXJuYXRpdmUgYWxsZWxlIHJhdGlvIHRocmVzaG9sZCBvZiBub21pbmFsbHkgc2lnbmlmaWNhbnQgTUFFIikgKyAKICB5bGFiKCJPZGRzIG9mIHBhdGhvZ2VuaWNpdHkgKE9kZHNQYXRoKSIpICsKICBsYWJzKGZpbGwgPSAiVmFyaWFudCB0eXBlIiwgCiAgICAgICBjb2xvdXIgPSAiVmFyaWFudCB0eXBlIiwgCiAgICAgICBzaGFwZSA9ICJFdmlkZW5jZSBzdHJlbmd0aFxuZXF1aXZhbGVudCIpKyAgCiAgc2NhbGVfY29sb3JfYnJld2VyKHBhbGV0dGUgPSAiUGFzdGVsMiIpKwogIHNjYWxlX2ZpbGxfYnJld2VyKHBhbGV0dGUgPSAiUGFzdGVsMiIpKwogICNzY2FsZV9maWxsX21hbnVhbCh2YWx1ZXMgPSB2YXJpYW50X2NvbG9ycykgKwogIHNjYWxlX3NoYXBlX21hbnVhbCh2YWx1ZXMgPSBldmlkZW5jZV9zaGFwZSApICsKICBzY2FsZV94X3JldmVyc2UoYnJlYWtzPSBjKCAwLjEsIDAuMiwgMC4zLCAwLjQsIDAuNSksIGxhYmVscyA9IGMoICI8MC4xIiwgIjwwLjIiLCAiPDAuMyIsICI8MC40IiwgIjwwLjUiKSkgKwogIGd1aWRlcyhmaWxsPUZBTFNFKSsKICAKICB0aGVtZV9jbGFzc2ljKCkrCiAgdGhlbWUoYXhpcy50aXRsZS55PSBlbGVtZW50X3RleHQoIHNpemU9MTIsICBmYWNlPSJib2xkIiksCiAgICAgICAgYXhpcy50aXRsZS54PSBlbGVtZW50X3RleHQoIHNpemU9MTIsICBmYWNlPSJib2xkIiksCiAgICAgICAgYXhpcy50ZXh0LnggPSBlbGVtZW50X3RleHQoZmFjZT0iYm9sZCIsICBzaXplPTEyKSwKICAgICAgICBheGlzLnRleHQueT0gZWxlbWVudF90ZXh0KGZhY2U9ImJvbGQiLCAgc2l6ZT0xMikpCiMrIGZpZy53aWR0aD0xMCwgZmlnLmhlaWdodD03CnAyCgoKCgojJyBTdXBwIGZpZ3VyZSBwYXBlcgoKc3VwX21hZSA8LSAgKCBQU19hICB8IHAyICkgKyBwbG90X2xheW91dChndWlkZXMgPSAnY29sbGVjdCcpICsgcGxvdF9hbm5vdGF0aW9uKHRhZ19sZXZlbHMgPSAnYScpICYgCiAgdGhlbWUocGxvdC50YWcgPSBlbGVtZW50X3RleHQoIHNpemU9MTQsICBmYWNlPSJib2xkIikpCiMrIGZpZy53aWR0aD0xMCwgZmlnLmhlaWdodD03CnN1cF9tYWUKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoK</div>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("MAE.R");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
